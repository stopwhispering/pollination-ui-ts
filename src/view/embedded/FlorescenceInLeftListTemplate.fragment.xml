<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
	xmlns:custom="pollination.ui.control"
>
    <CustomListItem>
        <HBox>
            <HBox>
                <VBox>
                    <Text
                        text="{currentFlorescencesModel>plant_id}"
                        class="sapUiTinyMarginBegin"
                        width="2.0rem"
                    />
                    <Button
                        class="tinyButton sapUiTinyMarginBegin"
                        icon="sap-icon://edit"
                        type="Transparent"
                        press=".onPressEditActiveFlorescence"
                    />
                </VBox>
                <FormattedText 
                    htmlText="{= ${currentFlorescencesModel>plant_name} 
                        + '&lt;br&gt;' 
                        + '&lt;span style=&quot;color:gray; font-style: italic;&quot;&gt;' + ${currentFlorescencesModel>plant_taxon_name}
                        + (!!${currentFlorescencesModel>comment} ? '&lt;br&gt; [' + ${currentFlorescencesModel>comment} + ']' : '')
                        + '&lt;/span&gt;'
                    }"
                    class="sapUiTinyMarginBegin"
                    width="16rem"
                />
                <VBox width="2rem">
                <Text
                    text="⸙ {currentFlorescencesModel>branches_count}"
                    visible="{= !!${currentFlorescencesModel>branches_count} }"
                    tooltip="{currentFlorescencesModel>branches_count} branch(es)"
                    class="sapUiTinyMarginBegin"
                    width="1.4rem"
                />
                <Text
                    text="⁕ {currentFlorescencesModel>flowers_count}"
                    visible="{= !!${currentFlorescencesModel>flowers_count} }"
                    tooltip="{currentFlorescencesModel>flowers_count} flowers"
                    class="sapUiTinyMarginBegin"
                    width="2rem"
                />
                </VBox>
                <VBox alignItems="Center">
                    <FormattedText
                        htmlText="{
                            parts: [
                                'currentFlorescencesModel>inflorescence_appeared_at',
                                'currentFlorescencesModel>first_flower_opened_at',
                                'currentFlorescencesModel>last_flower_closed_at',
                                'currentFlorescencesModel>florescence_status'
                            ],
                            formatter: '.formatter.html_for_active_florescence_dates'
                        }"
                        tooltip="Inflorescence appeared: {currentFlorescencesModel>inflorescence_appeared_at}, First flower opens: {currentFlorescencesModel>first_flower_opened_at}, Last flower closed: {currentFlorescencesModel>last_flower_closed_at}"
                        width="3.5rem"
                    />
                    <HBox visible="{=
                        !!${currentFlorescencesModel>flower_color} || !!${currentFlorescencesModel>flower_color_second}
                    }">
                        <core:Icon
                            visible="{= 
                                !!${currentFlorescencesModel>flower_color}
                            }"
                            src="sap-icon://color-fill"
                            color="{currentFlorescencesModel>flower_color}"
                            size="0.7rem"
                        >
                            <core:layoutData>
                                <FlexItemData growFactor="1" />
                            </core:layoutData>
                        </core:Icon>
                        <core:Icon
                            visible="{= 
                                !!${currentFlorescencesModel>flower_color_second}
                            }"
                            src="sap-icon://color-fill"
                            color="{currentFlorescencesModel>flower_color_second}"
                            size="0.7rem"
                        >
                            <core:layoutData>
                                <FlexItemData growFactor="1" />
                            </core:layoutData>
                        </core:Icon>
                    </HBox>
                </VBox>
            </HBox>
            <custom:HoverImage
                width="80px"
                densityAware="true"
                visible="{= !!${currentFlorescencesModel>plant_preview_image_id} }"
                src="{
                    path: 'currentFlorescencesModel>plant_preview_image_id',
                    formatter: '.formatter.getImageUrlAvatarL'
                }"
                plantName="{currentFlorescencesModel>plant_name}"
                plantId="{currentFlorescencesModel>plant_id}"
                hoverPress=".onHoverPressPreviewImage"
                />
        </HBox>
    </CustomListItem>
    
</core:FragmentDefinition>