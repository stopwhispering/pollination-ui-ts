<c:FragmentDefinition
	xmlns="sap.m"
	xmlns:c="sap.ui.core"
	xmlns:core="sap.ui.core"
>
	<Dialog
		id="editFlorescence"
		title="Edit Florescence (ID {editedFlorescenceModel>/id})"
		class="sapUiContentPadding sapUiSizeCompact"
		afterClose=".onAfterCloseEditFlorescenceDialog"
	>
		<content>
			<VBox>
				<Text text="{editedFlorescenceModel>plant_name} {editedFlorescenceModel>plant_id}"/>
				<SegmentedButton
					selectedKey="{editedFlorescenceModel>/florescence_status}"
					class="sapUiSmallMarginBottom"
					width="25rem"
				>
					<items>
						<SegmentedButtonItem
							text="{i18n>EditFlorescenceFragment.InflorescenceAppeared}"
							tooltip="{i18n>EditFlorescenceFragment.InflorescenceAppeared}"
							key="inflorescence_appeared"
						/>
						<SegmentedButtonItem
							text="{i18n>EditFlorescenceFragment.Flowering}"
							tooltip="{i18n>EditFlorescenceFragment.Flowering}"
							key="flowering"
						/>
						<SegmentedButtonItem
							text="{i18n>EditFlorescenceFragment.Finished}"
							tooltip="{i18n>EditFlorescenceFragment.Finished}"
							key="finished"
						/>
					</items>
				</SegmentedButton>
				<HBox class="sapUiSmallMarginBottom">
					<VBox class="sapUiSmallMarginEnd">
						<Label text="Inflorescence appeared at"/>
						<HBox>
							<CheckBox selected="{editedFlorescenceModel>/inflorescence_appearance_date_known}"/>
							<MaskInput
								enabled="{editedFlorescenceModel>/inflorescence_appearance_date_known}"
								value="{editedFlorescenceModel>/inflorescence_appearance_date}"
								mask="9999-99-99"
								width="6rem"
								class="sapUiTinyMarginEnd"
							/>
							<Button
								icon="sap-icon://calendar"
								type="Transparent"
								enabled="{editedFlorescenceModel>/inflorescence_appearance_date_known}"
								press=".onPressEditFlorescenceSetToday('inflorescence_appearance_date')"
							/>
						</HBox>
					</VBox>
					<VBox>
						<Label text="Comment"/>
						<TextArea
							value="{editedFlorescenceModel>/comment}"
							class="sapUiMediumMarginEnd sapUiTinyMarginBottom"
							maxLength="110"
							width="95%"
							placeholder="(e.g. location if multiple plants in one container)"
						/>
					</VBox>
				</HBox>
				<HBox class="sapUiSmallMarginBottom">
					<VBox class="sapUiSmallMarginEnd">
						<Label text="First flower opened at"/>
						<HBox>
							<CheckBox
								enabled="{= (${editedFlorescenceModel>/florescence_status} === 'flowering' 
										|| ${editedFlorescenceModel>/florescence_status} === 'finished')
								}"
								selected="{editedFlorescenceModel>/first_flower_opening_date_known}"
							/>
							<MaskInput
								enabled="{editedFlorescenceModel>/first_flower_opening_date_known}"
								value="{editedFlorescenceModel>/first_flower_opening_date}"
								mask="9999-99-99"
								width="6rem"
								class="sapUiTinyMarginEnd"
							/>
							<Button
								icon="sap-icon://calendar"
								type="Transparent"
								enabled="{editedFlorescenceModel>/first_flower_opening_date_known}"
								press=".onPressEditFlorescenceSetToday('first_flower_opening_date')"
							/>
						</HBox>
					</VBox>
					<VBox>
						<Label
							text="{i18n>EditFlorescenceFragment.Branches}"
							labelFor="sliderBranches"
						/>
						<HBox>
							<CheckBox selected="{editedFlorescenceModel>/branches_count_known}"/>
							<Slider
								id="sliderBranches"
								enabled="{editedFlorescenceModel>/branches_count_known}"
								value="{editedFlorescenceModel>/branches_count}"
								inputsAsTooltips="true"
								enableTickmarks="true"
								min="1"
								max="4"
								width="10rem"
							/>
						</HBox>
					</VBox>
				</HBox>
				<VBox>
					<Label
						text="Flowers (first branch only)"
						labelFor="inputFlowers"
					/>
					<HBox>
						<CheckBox selected="{editedFlorescenceModel>/flowers_count_known}"/>
						<Input
							id="inputFlowers"
							type="Number"
							maxLength="2"
							enabled="{editedFlorescenceModel>/flowers_count_known}"
							value="{editedFlorescenceModel>/flowers_count}"
							width="1.5rem"
							class="sapUiMediumMarginEnd"
						/>
						<Slider
							id="sliderFlowers"
							enabled="{editedFlorescenceModel>/flowers_count_known}"
							value="{editedFlorescenceModel>/flowers_count}"
							inputsAsTooltips="true"
							enableTickmarks="true"
							min="1"
							max="50"
							class="sapUiMediumMarginBottom"
							width="18rem"
						/>
					</HBox>
				</VBox>
				<VBox>
					<Label
						text="Flower Size"
						labelFor="sliderPerianthLength"
					/>
					<HBox>
						<CheckBox selected="{editedFlorescenceModel>/perianth_size_known}"/>
						<VBox>
							<Label text="{= 'Length ' +
								(${editedFlorescenceModel>/perianth_size_known} ? ${editedFlorescenceModel>/perianth_length} + ' cm' : '')
								}
								"/>
							<Slider
								id="sliderPerianthLength"
								enabled="{editedFlorescenceModel>/perianth_size_known}"
								value="{editedFlorescenceModel>/perianth_length}"
								inputsAsTooltips="true"
								enableTickmarks="true"
								min="0.1"
								max="8.0"
								step="0.1"
								class="sapUiMediumMarginBottom"
								width="11rem"
							/>
						</VBox>
						<VBox>
							<Label text="{= 'Diameter ' +
								(${editedFlorescenceModel>/perianth_size_known} ? ${editedFlorescenceModel>/perianth_diameter} + ' cm' : '')
								}
								"/>
							<Slider
								id="sliderPerianthDiameter"
								enabled="{editedFlorescenceModel>/perianth_size_known}"
								value="{editedFlorescenceModel>/perianth_diameter}"
								inputsAsTooltips="true"
								enableTickmarks="true"
								min="0.1"
								max="3.0"
								step="0.1"
								class="sapUiMediumMarginBottom"
								width="11rem"
							/>
						</VBox>
					</HBox>
				</VBox>
				<VBox 
								class="sapUiSmallMarginBottom">
					<Label
						text="Flower Colors"
						labelFor="sliderPerianthLength"
					/>
					<HBox>
						<HBox alignItems="End">
							<CheckBox selected="{editedFlorescenceModel>/flower_colors_known}"/>
							<SegmentedButton
								selectedKey="{editedFlorescenceModel>/flower_colors_differentiation}"
								enabled="{editedFlorescenceModel>/flower_colors_known}"
								class="sapUiTinyMarginEnd"
								width="18rem"
							>
								<items>
									<SegmentedButtonItem
										text="Uniform"
										tooltip="Uniform color (except for e.g. green mouth)"
										key="uniform"
									/>
									<SegmentedButtonItem
										text="Top-Bottom"
										tooltip="Different color on top and bottom"
										key="top_bottom"
									/>
									<SegmentedButtonItem
										text="Ovary-Mouth"
										tooltip="Different color on beginning and corolla mouth section"
										key="ovary_mouth"
									/>
								</items>
							</SegmentedButton>
						</HBox>
						<HBox>
							<core:Icon
								visible="{editedFlorescenceModel>/flower_colors_known}"
								src="sap-icon://color-fill"
								color="{
									path: 'editedFlorescenceModel>/flower_color'
								}"
								press="onFirstColorPress"
								size="1.8rem"
								tooltip="{
									path: 'editedFlorescenceModel>/flower_color'
								}"
								class="sapUiTinyMarginEnd"
							/>
							<core:Icon
								visible="{= 
										${editedFlorescenceModel>/flower_colors_known} &amp;&amp; ${editedFlorescenceModel>/flower_colors_differentiation} !== 'uniform' 
									}"
								src="sap-icon://color-fill"
								color="{
									path: 'editedFlorescenceModel>/flower_color_second'
								}"
								press="onSecondColorPress"
								size="1.8rem"
								tooltip="{
									path: 'editedFlorescenceModel>/flower_color_second'
								}"
								class="sapUiTinyMarginEnd"
							/>
							<!-- <Input
								enabled="{editedFlorescenceModel>/flower_colors_known}"
								value="{editedFlorescenceModel>/flower_color_second}"
								width="4rem"
								class="sapUiTinyMarginEnd"
							/> -->
						</HBox>
					</HBox>
				</VBox>
				<VBox class="sapUiSmallMarginBottom">
					<Label
						text="Stigma Position"
						labelFor="sliderPerianthLength"
					/>
					<HBox>
						<CheckBox selected="{editedFlorescenceModel>/stigma_position_known}"/>
						<SegmentedButton
							selectedKey="{editedFlorescenceModel>/stigma_position}"
							enabled="{editedFlorescenceModel>/stigma_position_known}"
							width="23rem"
						>
							<items>
								<SegmentedButtonItem
									text="exserted"
									tooltip="exserted"
									key="exserted"
								/>
								<SegmentedButtonItem
									text="mouth"
									tooltip="at corolla mouth level"
									key="mouth"
								/>
								<SegmentedButtonItem
									text="inserted"
									tooltip="inserted, equal or longer than anthers"
									key="inserted"
								/>
								<SegmentedButtonItem
									text="deeply inserted"
									tooltip="deeply inserted, below anthers"
									key="deeply_inserted"
								/>
							</items>
						</SegmentedButton>
					</HBox>
				</VBox>
				<VBox>
					<Label text="Last flower closed at"/>
					<HBox class="sapUiSmallMarginBottom">
						<CheckBox
							enabled="{= ${editedFlorescenceModel>/florescence_status} === 'finished'}"
							selected="{editedFlorescenceModel>/last_flower_closing_date_known}"
						/>
						<MaskInput
							enabled="{editedFlorescenceModel>/last_flower_closing_date_known}"
							value="{editedFlorescenceModel>/last_flower_closing_date}"
							mask="9999-99-99"
							width="6rem"
							class="sapUiTinyMarginEnd"
						/>
						<Button
							icon="sap-icon://calendar"
							type="Transparent"
							enabled="{editedFlorescenceModel>/last_flower_closing_date_known}"
							press=".onPressEditFlorescenceSetToday('last_flower_closing_date')"
						/>
					</HBox>
				</VBox>
			</VBox>
		</content>
		<buttons>
			<Button
				text="Set Aborted"
				icon="sap-icon://sys-cancel"
				press=".onPressAbortFlorescence"
				type="Critical"
			/>
			<Button
				text="{i18n>EditFlorescenceFragment.Delete}"
				icon="sap-icon://delete"
				press=".onPressDeleteFlorescence"
				type="Negative"
			/>
			<Button
				text="{i18n>EditFlorescenceFragment.Submit}"
				type="Emphasized"
				press=".onPressSubmitEditFlorescence"
			/>
			<Button
				text="{i18n>EditFlorescenceFragment.Cancel}"
				press=".onCancelDialog"
			/>
		</buttons>
	</Dialog>
</c:FragmentDefinition>